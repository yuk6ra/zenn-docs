---
title: "ã€Pythonã€‘OAuth2.0èªè¨¼ã‚’åˆ©ç”¨ã—ã¦Twitter APIã¨é€£æºã—ã€èªè¨¼ã•ã‚ŒãŸTwitter IDã‚’å¾—ã‚‹æ–¹æ³•"
emoji: "ğŸ¤©"
type: "tech"
topics:
  - "python"
  - "twitter"
  - "api"
  - "oauth"
  - "oauth2"
published: true
published_at: "2023-01-28 01:27"
---

ã¯ã˜ã‚ã¦Zennã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã©ã‚“ãªæ„Ÿã˜ãªã®ã‹ãªã¨æ€ã„ã€è©¦ã—ã«æ›¸ã„ã¦ã„ã‚‹æ„Ÿã˜ã§ã™ã®ã§ã€ä½•å’å®œã—ããŠé¡˜ã„è‡´ã—ã¾ã™ã€‚çš†ã•ã‚“ã‚‚ãã†ã ã¨æ€ã„ã¾ã™ãŒã€å­¦ã³ãªã‚‰ã‚„ã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€é–“é•ã£ãŸæƒ…å ±ã‚‚ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚ãã®éš›ã¯ã€é æ…®ãªãã”æŒ‡æ‘˜ã—ã¦ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

# ã¯ã˜ã‚ã«

å¼Šç¤¾ã§Web3é–¢é€£ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚’é–‹ç™ºã™ã‚‹ã«ã‚ãŸã‚Šã€ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ­ã‚°ã‚¤ãƒ³ã§åˆ©ç”¨ï¼‰ã¨Twitterã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã•ã›ã‚‹å¿…è¦æ€§ãŒã§ã¦ãã¾ã—ãŸã€‚æµ·å¤–ã®Web3ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚’è¦‹ã¦ã„ã¦ã‚‚ã€OAuth2.0ãŒä¸»æµã®ã‚ˆã†ã§ã™ã€‚

Twitterã¯æ˜”Pythonã§éŠã‚“ã§ãŸé ƒã«APIä½¿ã£ã¦ã„ãŸã‚‚ã®ã®ã€ä»Šå›OAuth2.0ã¯åˆã‚ã¦ã§ã™ã€‚å®Ÿéš›ã«ã©ã†ã‚„ã£ã¦é€£æºã•ã›ã¦ã„ã‚‹ã®ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€æ•£ã‚‰ã°ã£ã¦ã„ã‚‹çŸ¥è­˜ã‚’çµ„ã¿åˆã‚ã›ãªãŒã‚‰è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚æ„å¤–ã¨è©³ã—ã„è¨˜äº‹ãŒãªãã¦å›°ã‚Šã¾ã—ãŸï¼

ä»Šå›ã¯Access Tokenã‚’å–å¾—ã—ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã—ãŸTwitterã®IDã‚’å¾—ã‚‹ã¨ã“ã‚ã¾ã§å®Ÿè£…ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

# å‰æçŸ¥è­˜

- Twitter API
- PKCEï¼ˆProof Key Code Exchangeï¼‰
- Python
- OAuth2.0ã®ä»•çµ„ã¿
- ï¼ˆPostmanï¼‰

# å®Ÿè£…

## å…¨ä½“ã®æµã‚Œ
1. Twitter APIã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«Developer Portalã§è«¸è¨­å®šã‚’è¡Œã†
2. Authorization Requestã‚’è¡Œã†
3. Access Tokenã‚’å–å¾—ã™ã‚‹
4. Access Tokenã‚’åˆ©ç”¨ã—ã¦Twitter IDã‚’å¾—ã‚‹

## Client IDã¨Client Secretã‚’å…¬å¼ã‹ã‚‰å–å¾—ã™ã‚‹

Twitter APIå‘¨ã‚Šã®è¨­å®šæ–¹æ³•ãªã©è©³ç´°ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ä»–ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://developer.twitter.com/en

ã“ã“ã¯é‡è¦ãªã¨ã“ã‚ã ã‘è©³ã—ãèª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã¯Developer Portalã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«è¡Œãã¾ã—ã‚‡ã†ã€‚

https://developer.twitter.com/en/portal/dashboard

`Redirect URI`ã¯OAuth2.0èªè¨¼å¾Œã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹URLã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚ã“ã®`Redirect URI`ã¯å¾Œã»ã©Authorization Requestã‚’è¡Œã†éš›ã«åˆ©ç”¨ã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/ebd92fd5dd7d-20230128.png)

æ¬¡ã«Client IDã¨Client Secretã‚’å–å¾—ã—ã¾ã—ã‚‡ã†ã€‚

![](https://storage.googleapis.com/zenn-user-upload/766edd28bdf4-20230127.png)

```python: sample.py
TWITTER_CLIENT_ID = os.getenv("TWITTER_CLIENT_ID")
TWITTER_CLIENT_SECRET = os.getenv("TWITTER_CLIENT_SECRET")
```

ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã‚‚è‰¯ã„ã§ã™ãŒã€å¿µã®ãŸã‚ã“ã®ã‚ˆã†ãªå½¢ã§ç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿ã¨ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚

## Authorization Requestã®ãŸã‚ã®URLã‚’ç”Ÿæˆã™ã‚‹

ä¸‹æº–å‚™ã¯æ•´ã„ã¾ã—ãŸã®ã§ã€æ—©é€Ÿã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ãã¾ã™ã€‚ä¸‹è¨˜ã¯Authorization Requestã®ãŸã‚ã®URLã‚’ç”Ÿæˆã™ã‚‹å®Œæˆã‚³ãƒ¼ãƒ‰ã¨å‡ºåŠ›çµæœã§ã™ã€‚

```python:get_authorization_request.py
import base64
import dotenv
import hashlib
import json
import os
import urllib.parse as parse

dotenv.load_dotenv()
TWITTER_CLIENT_ID = os.getenv("TWITTER_CLIENT_ID")

TOKEN_URL = "https://api.twitter.com/2/oauth2/token"
AUTH_URL = "https://twitter.com/i/oauth2/authorize"
REDIRECT_URI = "http://localhost:3000/twitter/redirect"
SCOPE = ["users.read", "tweet.read"]

state = hashlib.sha256(os.urandom(32)).hexdigest()

code_verifier = hashlib.sha256(os.urandom(128)).hexdigest()
code_challenge_sha256 = hashlib.sha256(code_verifier.encode()).digest()
code_challenge = base64.urlsafe_b64encode(code_challenge_sha256).decode().rstrip("=")

query_parameter = parse.urlencode({
    'client_id': TWITTER_CLIENT_ID,
    'redirect_uri': REDIRECT_URI,
    'state': state,
    'scope': ' '.join(SCOPE),
    'response_type': 'code',
    'code_challenge': code_challenge,
    'code_challenge_method': 'S256',
})

request_url = f'{AUTH_URL}?{query_parameter}'
```

```json: output
{
'request_url': 'https://twitter.com/i/oauth2/authorize?client_id=N04tOTZUbjIwb0VIMDBMVlcxN1I6MTpjaQ&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fredirect&state=b2262218cd73792b71b862397afa0a0c1c3077f17e9947890701a7b1d9fe32d6&scope=users.read+tweet.read+follows.read&response_type=code&code_challenge=JOgyZWsvZLPy_u18dr4d4nBYH1pKzPJFtac_afNSrHY&code_challenge_method=S256',
'state': 'b2262218cd73792b71b862397afa0a0c1c3077f17e9947890701a7b1d9fe32d6', 
'code_verifier': '15d1dc906b3739ecaca6e721cdf0cf72845d1714a173eafd678812d97f295f15'
}
```

`query_parameter`ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

- **client_id**
Twitter APIã®Developer Portalã§å–å¾—ã—ãŸClient ID
- **redirect_uri**
Developer Portalã§è¨­å®šã—ãŸRedirect URI
- **state**
CSRFå¯¾ç­–ç”¨ã®ä»»æ„å€¤
- **scope**
ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã™ã‚‹æ¨©é™ç¯„å›²ã€‚ä¸‹è¨˜ã®Docsã«ã¯`tweet.write`ã‚„`like.write`ãªã©ã«ã¤ã„ã¦è©³ç´°ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚
https://developer.twitter.com/en/docs/authentication/oauth-2-0/authorization-code
- **state**
CSRFå¯¾ç­–ç”¨ã®ä»»æ„å€¤
- **response_type**
`code`å›ºå®š
- **code_challenge**
`code_challenge_method`ã§è¨­å®šã—ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ç®—å‡ºã—ãŸå€¤ã€‚
- **code_challenge_method**
`plane`ã‚‚ã—ãã¯`S256`ã€‚`plane`ã®å ´åˆã¯ã€`code_challenge`ã¨`code_verifier`ã¯åŒã˜å€¤ã«ã™ã‚‹ã€‚`S256`ã®å ´åˆã¯`code_challenge`ã®å€¤ã‚’SHA256ã§ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦BASE64URL Encodingã—ãŸå€¤ã«ã™ã‚‹ã€‚ä»Šå›ã¯`S256`ã§è©¦ã™ã€‚

[ã“ã¡ã‚‰](https://zenn.dev/kg0r0/articles/8b1cfe654a1cee)ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¾ã—ãŸã€‚


## ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã—ã¦Codeã‚’å¾—ã‚‹

```python:redirect_uri
https://twitter.com/i/oauth2/authorize?client_id=N04tOTZUbjIwb0VIMDBMVlcxN1I6MTpjaQ&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fredirect&state=b2262218cd73792b71b862397afa0a0c1c3077f17e9947890701a7b1d9fe32d6&scope=users.read+tweet.read+follows.read&response_type=code&code_challenge=JOgyZWsvZLPy_u18dr4d4nBYH1pKzPJFtac_afNSrHY&code_challenge_method=S256
```
å…ˆã»ã©ã®`output`ã®`request_url`ã®ãƒªãƒ³ã‚¯ã§ã€è‡ªèº«ãŒæ‰€æœ‰ã™ã‚‹Twitterã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’ã—ã¾ã™ã€‚ãªãŠã€**ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã—ã¦ã‹ã‚‰30ç§’ä»¥å†…ã§Access Tokenã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆè©³ã—ãã¯æ¬¡ï¼‰ã€‚** æ€ã£ãŸã‚ˆã‚Šã‚‚æ—©ã„ã§ã™ï¼

ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’ã™ã‚‹ã¨ä¸‹è¨˜ã®`response`ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚

```python:response
http://localhost:3000/twitter/redirect?state=4b1ce2276ac4609a545401729073c007e2def72b0acba4ee22d02d62be7361bf&code=RlRRa0hHX3dNZzVYV1VFdkZjMU1lX2wxeVQzUDduVi15bE01NFdBVF95WVFVOjE2NzQ4MjgzOTU0MDk6MTowOmFjOjE
```

- **http://localhost:3000/twitter/redirect**
Developer Portalã§è¨­å®šã—ãŸRedirect URIã§ã™ã€‚
- **state**
ãƒ•ãƒ­ãƒ³ãƒˆå´ã¯å®Œå…¨ç„¡è¦–ã—ã¦ã¾ã™ã®ã§ã“ã¡ã‚‰ã¯åˆ©ç”¨ã—ã¾ã›ã‚“ã€‚
`4b1ce2276ac4609a545401729073c007e2def72b0acba4ee22d02d62be7361bf`
- **code** 
Access Tokenã‚’å–å¾—ã™ã‚‹ãŸã‚ã«å¿…è¦ãªCodeã«ãªã‚Šã¾ã™ã€‚`RlRRa0hHX3dNZzVYV1VFdkZjMU1lX2wxeVQzUDduVi15bE01NFdBVF95WVFVOjE2NzQ4MjgzOTU0MDk6MTowOmFjOjE`

### ã‚¨ãƒ©ãƒ¼: Something went wrong

æœ€åˆã®é–¢é–€ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚`request_url`ã®ãƒªãƒ³ã‚¯ã‚’é–‹ãã¨ã“ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

```text:error
Something went wrong
You weren't able to give access to the App. Go back and
try logging in again.
```

![](https://storage.googleapis.com/zenn-user-upload/f4f630463d6c-20230128.png)

ãŸã¨ãˆã°ã€`request_url`ãŒè¨­å®šã—ãŸURIã¨é•ã£ãŸURIã‚’å…¥ã‚Œã¦ã—ã¾ã£ãŸå ´åˆã€ã†ã¾ãAuthorization Requestã‚’é£›ã°ã™ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚`http://localhost:3000/twitter/redirect`ã¨æ›¸ã„ãŸã¤ã‚‚ã‚ŠãŒã€`http://localhost:3000/redirect`ã«ãªã£ã¦ã„ãŸã‚Šã€‚æ¬ æã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’æ¢ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## Access Tokenã‚’å–å¾—ã™ã‚‹
ä¸‹è¨˜ã¯Access Tokenã‚’å–å¾—ã™ã‚‹ãŸã‚ã®å®Œæˆã‚³ãƒ¼ãƒ‰ã¨å‡ºåŠ›çµæœã§ã™ã€‚
```python:get_access_token.py
import hashlib
import os
import json
import urllib.parse as parse
import urllib.request as req
import base64
import dotenv

TWITTER_CLIENT_SECRET = os.getenv("TWITTER_CLIENT_SECRET")

# ç”Ÿæˆã•ã‚ŒãŸCodeã¨ç”Ÿæˆã—ãŸCode Verifierã«ç½®æ›ã™ã‚‹
code = "code"
code_verifier = "code_verifier"

data = parse.urlencode({
    'client_id': TWITTER_CLIENT_ID,
    'client_secret': TWITTER_CLIENT_SECRET,
    'redirect_uri': REDIRECT_URI,
    'grant_type': 'authorization_code',
    'code': code,
    'code_verifier': code_verifier
}).encode('utf-8')


# Basicèªè¨¼ã§URLå…ˆã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾—ã‚‹
authorization = base64.b64encode(
    f'{TWITTER_CLIENT_ID}:{TWITTER_CLIENT_SECRET}'.encode('utf-8')
).decode('utf-8')

request = req.Request(
    TOKEN_URL,
    headers={
        'Content-Type': 'application/x-www-form-urlencoded',
        'Authorization': f'Basic {authorization}'
    }
)

with req.urlopen(request, data=data) as token_res:
    res = token_res.read()

print(res)

```

```json:output
{
  'token_type': 'bearer',
  'expires_in': 7200,
  'access_token':
'M0UxenAyN0hveVBpMVFlcTJ3SlVHLVdPSE5kYjdXWnp4X1pFa0ZZSi1ibDQzOjE2NzQ4MzUwNTIyMDM6MTowOmF0OjE',
  'scope': 'users.read tweet.read'
}
```

`output`ã‚’è¦‹ã¦ãã ã•ã„ã€‚`access_token`ãŒç™ºè¡Œã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã§ã™ã€‚expires_in`ã¯ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ã§ã€7200ç§’ãªã®ã§2æ™‚é–“æœ‰åŠ¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§Twitter APIã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

`get_access_token.py`ã‚’ã¿ã¦è¦‹ã¾ã—ã‚‡ã†ã€‚ã“ã“ã§é‡è¦ãªã®ã¯ã€`code`ã¨`code_verifier`ã§ã™ã€‚ã€Œã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã—ã¦Codeã‚’å¾—ã‚‹ã€ã«ã¦ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§è¿”ã£ã¦ããŸ`code`ã¨ã€ŒAuthorization Requestã®ãŸã‚ã®URLã‚’ç”Ÿæˆã™ã‚‹ã€ã§ç”Ÿæˆã—ãŸ`code_verifier`ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚**30ç§’ä»¥å†…ã«è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚**

ã¾ãŸã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®å‡¦ç†ã‚’è¡Œã£ã¦ã„ã‚‹äººã¯ã€`code`ã¨`code_verifier`ãŒ**ã—ã£ã‹ã‚Šç´ã¥ã„ã¦ã„ã‚‹ã‹**ã«æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è­˜åˆ¥ã«`state`ãŒå½¹ç«‹ã¤ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚ˆã`code`ã¯æœ€æ–°ã ã‘ã‚Œã©ã€`code_verifier`ã¯é•ã†å€¤ã«ãªã£ã¦ã„ãŸã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ã•ã¦ã€`access_token`ã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã®ã§ä»Šåº¦ã¯åˆ©ç”¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## Access Tokenã‚’åˆ©ç”¨ã—ã¦Twitter IDã‚’å¾—ã‚‹

ãƒ©ã‚¹ãƒˆã‚¹ãƒ‘ãƒ¼ãƒˆã§ã™ãŒã€ã“ã“ã¯æ¯”è¼ƒçš„ç°¡å˜ã§ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ã•ãˆã‚ã‚Œã°ã€ä»–ã«ã‚‚å¿œç”¨ãŒã§ãã‚‹ã¨æ€ã†ã®ã§ã€è‰²ã€…ã¨è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

ä¸‹è¨˜ãŒå®Œæˆã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

```python:get_twitter_id.py
def get_twitter_id(access_token):
    url = 'https://api.twitter.com/2/users/me'
    
    # Paramsã®ä½¿ã„æ–¹ã‚‚å‚è€ƒç¨‹åº¦ã«
    params = {
        'user.fields': 'description'
    }

    # Access Tokenã‚’ã‚»ãƒƒãƒˆã™ã‚‹
    headers = {
        'Authorization': f'Bearer {access_token}'
    }

    res = requests.get(url, params=params, headers=headers)

    return eval(res.text)

get_twitter_id("Access Token")
```

```json:output
{
  'data': {
	'description': 'description',
	'id': 'id',
	'name': 'name',
	'username': 'username'
  }
}
```

`get_twitter_id.py`ã‚’è¦‹ã¦ãã ã•ã„ã€‚`get_twitter_id("Access Token")`ã«ã¯å½“ç„¶å…ˆã»ã©ç™ºè¡Œã—ãŸAccess TokenãŒå…¥ã‚Šã¾ã™ã€‚æ›¸ã‹ãªãã¦ã‚‚åˆ†ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒå¿µã®ãŸã‚æ›¸ã„ã¦ãŠãã¾ã™ã€‚
```python:sample
get_twitter_id("M0UxenAyN0hveVBpMVFlcTJ3SlVHLVdPSE5kYjdXWnp4X1pFa0ZZSi1ibDQzOjE2NzQ4MzUwNTIyMDM6MTowOmF0OjE")
```

æ¬¡ã«`output`ã‚’è¦‹ã¦ãã ã•ã„ã€‚`username`ãŒTwitter IDã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã®ã§ã€ä»Šå›ã®ç›®æ¨™ã¯é”æˆã§ã™ã€‚`params`ã®è¨­å®šã¯ã€ä¾‹ãˆã°ã€`user.fields`ã¯ä¸Šè¨˜ã§ã¯`'description'`ã—ã‹åˆ©ç”¨ã—ã¦ã„ã¾ã›ã‚“ãŒã€ä»–ã«ã‚‚`created_at`ã‚„`profile_image_url`ãªã©ãŒã‚ã‚Šã¾ã™ã€‚

https://developer.twitter.com/en/docs/twitter-api/users/lookup/api-reference/get-users-me

ã¾ãšã¯ã©ã®ã‚ˆã†ãªæŒ™å‹•ã«ãªã‚‹ã®ã‹ã‚’Postmanã§è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

https://developer.twitter.com/en/docs/tutorials/postman-getting-started


# ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å‡¦æ³•

```python:error
HTTPError: HTTP Error 400: Bad Request
```

## ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã—ã¦ã‹ã‚‰30ç§’ä»¥å†…ã«Access Tokenã‚’å¾—ã‚‹

ä½•åº¦ã‚‚æ›¸ãã¾ã—ãŸãŒã€30ç§’ã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’çŸ¥ã‚‰ãªã‹ã£ãŸã¨ãã¯æœ¬å½“ã«ã‚¨ãƒ©ãƒ¼ã®åŸå› ãŒä½•ãªã®ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€ã—ã£ã‹ã‚Š30ç§’ä»¥å†…ã«ã§ãã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚

## Code Challenge Methodã‚’Planeã«ã—ã¦è©¦ã™

ä¸Šè¨˜ã§ã¯ã€Code Challenge Methodã‚’`S256`ã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

ã‚‚ã—ã‹ã™ã‚‹ã¨`code_challenge`ã¨`code_verifier`ãŒåˆã£ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã®ã§ã€ç”ŸæˆãŒã†ã¾ãã„ã‹ãªã„å ´åˆã¯ã€`code_challenge_method`ã‚’`plane`ã«ã—ã¦ã€`code_challenge`ã¨`code_verifier`ã®å€¤ã‚’ä¸€è‡´ã•ã›ã¦ã¿ã¦ãã ã•ã„ã€‚

## Postmanã§æŒ™å‹•ã‚’è¦‹ç›´ã™

ã„ããªã‚Šã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã¨è¨³ãŒåˆ†ã‹ã‚‰ãªã„ã¨ããŒã‚ã‚Šã¾ã™ã€‚ã©ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã®ã‹ã€Twitterå´ãŒç”¨æ„ã—ã¦ãã‚Œã¦ã„ã‚‹Postmanã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å‹•ãã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚‚ã¡ã‚ã‚“ã€OAuth2.0ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ã¨ã“ã‚ã‹ã‚‰ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/db29c2ecf3ee-20230128.png)


## ãã®ä»–

ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆã¯ã€ã“ã¡ã‚‰ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Šã¾ã™ã€‚

https://zenn.dev/kg0r0/articles/8b1cfe654a1cee


```json: error
{
  "error": "unauthorized_client",
  "error_description": "Missing valid authorization header"
}
```

```json: error
{
  "error": "invalid_request",
  "error_description": "Missing required parameter [client_id]."
}
```

```json: error
{
  "error": "unauthorized_client",
  "error_description": "Missing valid authorization header"
}
```


# ã¾ã¨ã‚

ã ã„ãŸã„ã€èª¿ã¹ã¦ã„ã‚‹ã¨ãã£ã¦ã€Œã¾ã¨ã‚ã€è¦‹ã¾ã›ã‚“ã‚ˆã­ã€‚ç§ã®æ„Ÿæƒ³ã‚’é©å½“ã«ãŠã„ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚

é–‹ç™ºã—ãªãŒã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’å‡ºã—ã¦ã„ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã•ã‚“ã£ã¦æœ¬å½“ã«ã™ã”ã„ãªã¨æ€ã„ã¾ã™ã€‚ç§ã¯ã“ã‚Œã‚’ä½œæˆã™ã‚‹ã®ã«ã€3æ™‚é–“30åˆ†ã‚‚ã‹ã‹ã‚Šã¾ã—ãŸâ€¦ã€‚

æ™®æ®µã¯Notionã§é–‹ç™ºãƒãƒ¼ãƒˆã¨å‘¼ã‚“ã§ã„ã‚‹ãƒ¡ãƒ¢ã‚’æ®‹ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€è¦‹ç›´ã™ã“ã¨ã¯ã»ã¨ã‚“ã©ã‚ã‚Šã¾ã›ã‚“ã€‚è¦‹ç›´ã™ã®ã¯æœ€åˆã®ç’°å¢ƒæ§‹ç¯‰ãã‚‰ã„ã§ã™ã‹ã­ã€‚ãã‚Œã§ã‚‚ã€å‚è€ƒã«ãªã£ãŸè¨˜äº‹ã‚’ãƒ¡ãƒ¢ã—ãŸã‚Šã€æ°—ã¥ãã‚’ãƒ¡ãƒ¢ã—ãŸã‚Šã¯é‡è¦ã ã¨æ€ã„ã¾ã™ã—ã€è¦šãˆã‚‹ãŸã‚ã®ä¸€æ–¹ã«ã¯ãªã‚‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

ã•ã™ãŒã«æ™‚é–“ãŒã‹ã‹ã‚Šã™ããªã®ã§ã€æ‰‹ã®è¾¼ã‚“ã ã‚‚ã®ã¯æ›¸ã‘ãªã„ã¨æ€ã„ã¾ã™ãŒã€ä½•ã‹ã‚’ä¸€ã‹ã‚‰å¾©ç¿’ã—ãŸã‚Šã™ã‚‹ã¨ãã«ã¯Zennã‚’æ›¸ããªãŒã‚‰ï¼ˆã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã—ãªãŒã‚‰ï¼‰å­¦ç¿’ã—ã¦ã„ãã®ã‚‚è‰¯ã•ãã†ã§ã™ã€‚

æœ¬ä»¶ã¨ã¯é–¢ä¿‚ã®ãªã„æ›¸ãæ‰‹ã®æ‹™ã„æ„Ÿæƒ³ã§ã™ãŒã€è‰²ã€…ã¨ç™ºè¦‹ãŒã§ãã¦è‰¯ã‹ã£ãŸã¨æ€ã„ã¾ã™ã€‚é–“é•ã£ã¦ã„ã‚‹ã“ã¨ã‚‚ã”ã–ã„ã¾ã—ã‚‡ã†ãŒã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

ChatGPTã«è² ã‘ãªã„ã‚ˆã†ã«ãŸãã•ã‚“å­¦ã°ã­ã°ï¼

# å‚è€ƒæ–‡çŒ®
- https://zenn.dev/kg0r0/articles/8b1cfe654a1cee
- https://qiita.com/YouKnow/items/52b62d5487fa45df110c
- https://qiita.com/hoto17296/items/2d2cb76d323099e9f8abZ
- https://qiita.com/KWS_0901/items/a5595148c3fdf01bc2e7
