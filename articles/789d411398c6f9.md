---
title: "ã€Solidityã€‘Hardhatã‚’åˆ©ç”¨ã—ã¦çˆ†é€Ÿã§ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆé–‹ç™ºã®ç’°å¢ƒã‚’æ•´ãˆã‚‹"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
    - Solidity
published: false
---

# ã¯ã˜ã‚ã«

Solidityã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆé–‹ç™ºã§Hardhatã‚’ã‚ˆãåˆ©ç”¨ã—ã¾ã™ã€‚

æ¯å›æµã‚Œä½œæ¥­ã«ãªã£ã¦ã‚‹ã‚“ã§ã™ãŒã€2é€±é–“ãã‚‰ã„ç©ºãã¨ã€Œãˆãƒ¼â€¦ã£ã¨ã€ã¨æ‰‹ãŒæ­¢ã¾ã£ã¦ã€Notionã®å€‹äººç”¨ã«æ®‹ã—ã¦ã‚‹é–‹ç™ºãƒãƒ¼ãƒˆã‚’è¦‹è¿”ã•ãªãã‚ƒã„ã‘ãªããªã‚Šã¾ã™ã€‚ãƒãƒ¼ãƒˆè‡ªä½“ãŒã‚ã¾ã‚Šæ•´ç†ã•ã‚Œã¦ã„ãªã„ã®ã§æ¢ã™ã®ãŒé¢å€’ã§ã™ã€‚

ã—ãŸãŒã£ã¦ã€ä»Šå›ã¯è‡ªåˆ†ã®æ•´ç†ã‚‚å«ã‚ã¦ã€ãƒ‘ãƒ‘ã£ã¨é–‹ç™ºç’°å¢ƒã‚’æ•´ãˆã‚‹ãƒ¡ãƒ¢ã‚’æ®‹ã—ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜ã§ã¯ãªãã€æ‰‹é †ã®æ–¹æ³•ã‚’è¨˜è¼‰ã—ã¦ã„ãã¾ã™ã€‚

# å‰æçŸ¥è­˜

ä¸‹è¨˜ã®çŸ¥è­˜ã¯ã‚ã‚‹ã‚‚ã®ã¨ã—ã¦èª¬æ˜ã—ã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆã‚ãªã„å ´åˆã¯ã€ãã‚Œãã‚Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚

- WSL2
- EVM
- Node.js
- npm

```code:bash
$ npm -v
9.5.0
$ node -v
v18.15.0
```

# ç’°å¢ƒæ§‹ç¯‰

## 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ

`test-contract`ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚

```wsl:bash
mkdir test-contract
cd test-contract
```

## 2. åˆæœŸåŒ–

åˆæœŸåŒ–ã‚’è¡Œã£ã¦ã€`package.json`ã‚’æº–å‚™ã—ã¾ã™ã€‚ä»Šå›ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ã„ã¾ã™ã€‚

```wsl:bash
npm init -y
```

https://docs.npmjs.com/cli/v9/commands/npm-init


## 3. Hardhatã®å°å…¥

1. npmã§hardhatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
```code:bash
npm install hardhat --save-dev
```
2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒçµ‚ã‚ã£ãŸã‚‰ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
```code:bash
npx hardhat
```

3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹
ä»Šå›ã¯JavaScriptã‚’æ¡ç”¨ã—ã€ã™ã¹ã¦ã‚¨ãƒ³ã‚¿ãƒ¼ã‚’æŠ¼ã—ã¦ã„ãã¾ã™ã€‚å„è‡ªé¸æŠã—ã¦ãã ã•ã„ã€‚

```code:bash
888    888                      888 888               888
888    888                      888 888               888
888    888                      888 888               888
8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888
888    888     "88b 888P"  d88" 888 888 "88b     "88b 888
888    888 .d888888 888    888  888 888  888 .d888888 888
888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.
888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888

Welcome to Hardhat v2.13.0

? What do you want to do? â€¦ 
â–¸ Create a JavaScript project
  Create a TypeScript project
  Create an empty hardhat.config.js
  Quit
```

```
âœ” What do you want to do? Â· Create a JavaScript project
âœ” Hardhat project root: Â· /home/username/test-contract
âœ” Do you want to add a .gitignore? (Y/n) Â· y
âœ” Do you want to install this sample project's dependencies with npm (@nomicfoundation/hardhat-toolbox)? (Y/n) Â· y
```


4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹
ã“ã“ã¾ã§ã§ä¸‹è¨˜ã®ã‚ˆã†ãªæ§‹é€ ãŒã§ãã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚
```code:Tree
test-contract
â”œâ”€â”€ contracts
â”‚   â””â”€â”€ Lock.sol
â”œâ”€â”€ node_modules
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ deploy.js
â”œâ”€â”€ test
â”‚   â””â”€â”€ Lock.js
â”œâ”€â”€ .gitignore
â”œâ”€â”€ hardhat.config.js
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

5. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹
å‹•ä½œã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚

```code:bash
$ npx hardhat compile
Compiled 1 Solidity file successfully
```

```code:bash
$ npx hardhat test

  Lock
    Deployment
      âœ” Should set the right unlockTime (1248ms)
      âœ” Should set the right owner
      âœ” Should receive and store the funds to lock
      âœ” Should fail if the unlockTime is not in the future
    Withdrawals
      Validations
        âœ” Should revert with the right error if called too soon
        âœ” Should revert with the right error if called from another account
        âœ” Shouldn't fail if the unlockTime has arrived and the owner calls it
      Events
        âœ” Should emit an event on withdrawals
      Transfers
        âœ” Should transfer the funds to the owner

  9 passing (1s)
```

https://hardhat.org/hardhat-runner/docs/guides/project-setup

https://github.com/NomicFoundation/hardhat

## 4. .envãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š

ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã¸ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹éš›ã«ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ç§˜å¯†éµã‚„ãƒãƒ¼ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®API KEYãŒå¿…è¦ã«ãªã‚Šã¾ã™ã®ã§ã€`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ã„ãã¾ã™ã€‚

1. npmã§dotenvãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
```code:bash
npm install dotenv --save-dev
```

2. Hardhatãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹
```code:Tree
test-contract
â”œâ”€â”€ artifacts
â”œâ”€â”€ cache
â”œâ”€â”€ contracts
â”‚   â””â”€â”€ Lock.sol
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ deploy.js
â”œâ”€â”€ test
â”‚   â””â”€â”€ Lock.js
â”œâ”€â”€ .env <--- Creation
â”œâ”€â”€ .gitignore
â”œâ”€â”€ hardhat.config.js
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

3. `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«å¿…è¦ãªé …ç›®ã‚’å…¥åŠ›ã™ã‚‹
`PRIVATE_KEY`ã«ã¯åˆ©ç”¨ã™ã‚‹ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ç§˜å¯†éµã‚’å…¥åŠ›ã—ã¾ã™ã€‚æ¬¡ã«ã€ãƒãƒ¼ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ä»Šå›ã¯[alchemy](https://www.alchemy.com/)ã‚’æ¡ç”¨ã—ã¾ã™ã®ã§ã€`ALCHEMY_KEY`ã«ã¯HTTPSã®Alchemy API URLã‚’å…¥åŠ›ã—ã¾ã™ã€‚ã¤ã„ã§ã«`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã®ä¾‹ã‚’è¨˜å…¥ã™ã‚‹`.env.example`ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ä½œæˆã—ã¦ãŠãã¨ä¾¿åˆ©ã§ã™ã€‚

:::message
Githubã«Pushã™ã‚‹éš›ã€ç§˜å¯†éµã‚„ãã®ä»–ã®APIã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„ã€‚Hardhatãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆæ™‚ã«`.env`ãŒå…¥ã£ãŸ`.gitignore`ãŒç”Ÿæˆã•ã‚Œã¾ã™ãŒã€ä¸€å¿œç›®è¦–ã§ç¢ºèªã—ã¦ã‹ã‚‰Pushã—ã¾ã—ã‚‡ã†ã€‚**ç‰¹ã«ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¯é–‹ç™ºç”¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãªã©ã‚’ä½œæˆã—ã€ãã®ç§˜å¯†éµã‚’å–ã‚Šæ‰±ã†ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†**ã€‚
:::

```javascript:.env
PRIVATE_KEY = "YOUR_PRIVATE_KEY"
ALCHEMY_KEY = "https://eth-goerli.g.alchemy.com/v2/your-api-key"
```

```javascript:.env.example
PRIVATE_KEY = ""
ALCHEMY_KEY = ""
```

![](/images/789d411398c6f9/get-alchemy-api-key.gif)
*[Create and Deploy your Smart Contract using Hardhat](https://docs.alchemy.com/docs/hello-world-smart-contract)*

https://www.infura.io/

https://www.alchemy.com/


## 5. hardhat.config.jsãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š

`hardhat.config.js`ã‚’é–‹ãã€`goerli`ã‚’æƒ³å®šã™ã‚‹è¨­å®šã‚’è¨˜å…¥ã—ã¦ã„ãã¾ã™ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ã®è¨­å®šã§éšæ™‚è¨˜å…¥ã—ã¦ã„ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```javascript:hardhat.config.js
require("@nomicfoundation/hardhat-toolbox");

/** @type import('hardhat/config').HardhatUserConfig */
module.exports = {
  solidity: "0.8.18",
  networks: {
    goerli: {
      url: process.env.ALCHEMY_KEY,
      accounts: [process.env.PRIVATE_KEY],
    },
  },
};
```

https://hardhat.org/hardhat-runner/docs/config

## ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥

ãã®ä»–ã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã—ã¦ã„ãã¾ã™ã€‚

### hardhat-gas-reporterã®å°å…¥

ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹éš›ã®ã‚¬ã‚¹ä»£ã‚„ãã‚Œãã‚Œã®é–¢æ•°ã‚’å®Ÿè¡Œã—ãŸéš›ã®**ã‚¬ã‚¹ä»£ã‚’è¨ˆæ¸¬ã—ã¦ãã‚Œã‚‹Hardhatç”¨ã®ã‚¬ã‚¹ãƒ¬ãƒãƒ¼ã‚¿ãƒ¼**ã§ã™ã€‚

`npx hardhat test`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¬ã‚¹ä½¿ç”¨æ–™ã‚’è¨ˆç®—ã—ã¦ãã‚Œã¾ã™ã€‚ã¨ã¦ã‚‚ä¾¿åˆ©ã§ã™ã€‚

```code:bash
npm install hardhat-gas-reporter --save-dev
```
![](/images/789d411398c6f9/hardhat-gas-reporter.png)

https://github.com/cgewecke/hardhat-gas-reporter

### OpenZeppelinã®å°å…¥

[OpenZeppelin](https://www.openzeppelin.com/)ã¯ç²¾æŸ»ã•ã‚ŒãŸå®‰å…¨ãªã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’æä¾›ã™ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚å¿…è¦ã«å¿œã˜ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ã”è¦§ã®é€šã‚Šã€åˆ©ç”¨ã‚‚éå¸¸ã«ç°¡å˜ã§ã™ã€‚

```code:bash
npm install @openzeppelin/contracts
```

```solidity:Example.sol
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC721/ERC721.sol";
```

https://docs.openzeppelin.com/contracts/4.x/

https://github.com/OpenZeppelin/openzeppelin-contracts


# ãƒ‡ãƒ—ãƒ­ã‚¤

`scripts/deploy.js`ã‚’æ›¸ãä¸Šã’ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«åˆã‚ã›ã¦ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

:::message
**å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™**ã€‚ä½•åº¦ã‚‚å®Ÿè¡Œã—ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
:::

```code:template
npx hardhat run scripts/deploy.js --network your-network
```

```code:Goerli
npx hardhat run scripts/deploy.js --network goerli
```

```code:Mainnet
npx hardhat run scripts/deploy.js --network mainnet
```

https://hardhat.org/hardhat-runner/docs/guides/deploying#deploying-your-contracts


# æ¤œè¨¼

Goerliã®Etherscanã‚’æƒ³å®šã—ã¦ã¿ã¾ã™ã€‚

## 1. hardhat-etherscanã®å°å…¥
```code:bash
npm install @nomiclabs/hardhat-etherscan
```

https://github.com/NomicFoundation/hardhat/tree/main/packages/hardhat-etherscan

## 2. Etherscanã§æ¤œè¨¼ã™ã‚‹

1. [Etherscan.io](https://etherscan.io/)ã‹ã‚‰APIã‚’å–å¾—ã™ã‚‹
2. `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«`ETHERSCAN_KEY`ã¨ã—ã¦è¨˜è¼‰ã™ã‚‹
```javascript:.env
PRIVATE_KEY = ""
ALCHEMY_KEY = ""
ETHERSCAN_KEY = "YOUR_ETHERSCAN_API_KEY"
```
3. `hardhat.config.js`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šã‚’è¿½è¨˜ã™ã‚‹

```javascript:hardhat.config.js
module.exports = {
  networks: {
    mainnet: { ... }
  },
  etherscan: {
    // Your API key for Etherscan
    // Obtain one at https://etherscan.io/
    apiKey: process.env.ETHERSCAN_KEY
  }
};
```
4. ä¸‹è¨˜ã«å¾“ã£ã¦æ¤œè¨¼ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
A. å¯¾è±¡ã¨ãªã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®`constructor`ã«å¼•æ•°ãŒãªã„å ´åˆ
B. å¯¾è±¡ã¨ãªã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®`constructor`ã«å¼•æ•°ãŒã‚ã‚‹å ´åˆ

### A. constructorã«å¼•æ•°ãŒãªã„å ´åˆ
```code:template
npx hardhat verify --network goerli your-contract-address
```
```code:example
npx hardhat verify --network goerli 0x8a90CAb2b38dba80c64b7734e58Ee1dB38B8992e
```
### B. constructorã«å¼•æ•°ãŒã‚ã‚‹å ´åˆ

1. `args.js`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹

```code:Tree
test-contract
â”œâ”€â”€ artifacts
â”œâ”€â”€ cache
â”œâ”€â”€ contracts
â”‚   â””â”€â”€ Lock.sol
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ deploy.js
â”œâ”€â”€ test
â”‚   â””â”€â”€ Lock.js
â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”œâ”€â”€ args.js <---
â”œâ”€â”€ hardhat.config.js
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```
2. ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®`constructor`ã«å¯¾å¿œã™ã‚‹å¼•æ•°ã‚’å…¥åŠ›ã™ã‚‹
```javascript:args.js
module.exports = [
    "Argument 1",
    "Argument 2",
    "Argument 3",
]
```

3. æ¤œè¨¼ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
```code:template
npx hardhat verify --network goerli your-contract-address --constructor-args args.js
```

```code:example
npx hardhat verify --network goerli 0x8a90CAb2b38dba80c64b7734e58Ee1dB38B8992e --constructor-args args.js
```


# ã¾ã¨ã‚



# å‚è€ƒæ–‡çŒ®
https://github.com/NomicFoundation/hardhat
https://github.com/cgewecke/hardhat-gas-reporter
https://github.com/OpenZeppelin/openzeppelin-contracts
https://github.com/NomicFoundation/hardhat/tree/main/packages/hardhat-etherscan
https://www.alchemy.com/
https://www.infura.io/
https://goerlifaucet.com/
https://faucet.quicknode.com/drip
